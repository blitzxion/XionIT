@using XionIT.Models;
@model RegisterViewModel
@{
	ViewBag.Title = "New Person";
}

<div class="row">

	<p>Create a new person so they can have assets be assigned to them.</p>
</div>

@using (Html.BeginForm(@"create", "people", FormMethod.Post, new { @class = "form-horizontal" }))
{
	@Html.AntiForgeryToken()

	@Html.ValidationSummary("", new { @class = "text-danger" })

	<div class="form-group">
		@Html.LabelFor(x => x.Email, new { @class = "col-lg-2 control-label" })
		<div class="col-lg-10">
			@Html.EditorFor(x => x.Email, new { htmlAttributes = new { @class = "form-control" } })
		</div>
	</div>

	<div class="form-group">
		<label class="col-md-2 control-label">
			User Role
		</label>
		<div class="col-md-10">
			@Html.DropDownList(@"SelectedRoles", ((SelectList)ViewBag.RoleId).Reverse(), null, new { @class = "form-control" })
		</div>
	</div>

	<div class="passwordContainer hide">
		<div class="form-group">
			@Html.LabelFor(x => x.Password, new { @class = "col-lg-2 control-label" })
			<div class="col-lg-10">
				@Html.EditorFor(x => x.Password, new { htmlAttributes = new { @class = "form-control hide" } })
				<p class="help-block">Only Admins require a password! Passwords for normal users will be ignored.</p>
			</div>
		</div>

		<div class="form-group">
			@Html.LabelFor(x => x.ConfirmPassword, new { @class = "col-lg-2 control-label" })
			<div class="col-lg-10">
				@Html.EditorFor(x => x.ConfirmPassword, new { htmlAttributes = new { @class = "form-control hide" } })
			</div>
		</div>
	</div>

	<div class="form-group">
		<div class="col-md-offset-2 col-md-10">
			<input type="submit" class="btn btn-default" value="Create" />
		</div>
	</div>

}

@section Scripts {
	@Scripts.Render("~/bundles/jqueryval")

	<script>
		(function () {

			$('#SelectedRoles').on('change', function () {
				var role = $(this).val(),
					pwd = $('#Password'),
					cPwd = $('#ConfirmPassword'),
					pwdDiv = $('.passwordContainer');

				if (role == 'Admin') {
					pwd.removeClass('hide');
					cPwd.removeClass('hide');
					pwdDiv.removeClass('hide');
				} else {
					pwd.addClass('hide');
					cPwd.addClass('hide');
					pwdDiv.addClass('hide');
				}

			});
			$('#SelectedRoles').change();

		})();
	</script>

}